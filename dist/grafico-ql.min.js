!function(e,t){"function"==typeof define&&define.amd?define("grafico-ql",["exports"],t):"object"==typeof exports&&"string"!=typeof exports.nodeName?t(exports):t(e.GraficoQL={})}("undefined"!=typeof self?self:this,function(n){var o={headers:{},method:"POST"};function r(e,t){var r="Cannot initialize GraphQLClient, cause of missing ",n=" You can resolve this by providing a polyfill for it.";if(!fetch)throw new ReferenceError(r+"fetch-function!"+n);if(!Promise)throw new ReferenceError(r+"Promise-constructor!"+n);this[" url"]=e;this[" options"]=a(JSON.parse(JSON.stringify(o)),t||{})}r.prototype.setHeader=function(e,t){this[" options"].headers[e]=t;return this};function a(t,r){Object.keys(r).forEach(function(e){"object"!=typeof t[e]||null===t[e]?t[e]=r[e]:Array.isArray(t[e])?Array.isArray(r[e])&&(t[e]=t[e].concat(r[e])):"object"!=typeof r[e]||null===r[e]||Array.isArray(r[e])||(t[e]=a(t[e],r[e]))});return t}function s(e,t,r){var n,o=[this[" url"]],s={resolve:null,reject:null},i={};switch(this[" options"].method.toLowerCase()){case"post":this.setHeader("Content-Type","application/json");i.body=JSON.stringify({query:t,variables:r||void 0});break;case"get":this.setHeader("Content-Type","text/plain");o.push((-1===this[" url"].indexOf("?")?"?":"&")+"query="+encodeURIComponent(t));r&&o.push("&variables="+encodeURIComponent(JSON.stringify(r)));break;default:throw new Error("Invalid method ("+this[" options"].method+"). Use method GET or POST!")}s.promise=new Promise(function(e,t){s.resolve=e;s.reject=t});n=function(e,t,r,n,o){var s={};if(n.ok&&(o.data||o.errors))if(e){o.headers=n.headers;o.status=n.status;this.resolve(o)}else{o.errors&&(s.errors=o.errors);void 0!==o.data&&(s.data=o.data);"[object Object]"===Object.prototype.toString.call(o.extensions)&&(s.extensions=o.extensions);this.resolve(s)}else{(s="string"==typeof o?{error:o}:o||{}).status=n.status;e&&(s.headers=n.headers);this.reject({response:s,request:{query:t,variables:r}})}}.bind(s,e,t,r);fetch(o.join(""),a(this[" options"],i)).then(function(e){var t,r=n.bind(null,e);((t=(e=e).headers.get("Content-Type"))&&0===t.indexOf("application/json")?e.json():e.text().then(function(e){return JSON.parse(e)})).then(r,r)},function(e){s.reject({response:{status:900,error:e},request:{query:t,variables:r}})});return s.promise}r.prototype.request=function(e,t){return s.call(this,!1,e,t)};r.prototype.rawRequest=function(e,t){return s.call(this,!0,e,t)};a(n,{create:function(e,t){return new r(e,t)},request:function(e,t,r){return n.create(e).request(t,r)},rawRequest:function(e,t,r){return n.create(e).rawRequest(t,r)}})});"function"==typeof define&&define.amd&&define(["grafico-ql"],function(e){return e});