!function(e,t){"function"==typeof define&&define.amd?define("grafico-ql",["exports"],t):"object"==typeof exports&&"string"!=typeof exports.nodeName?t(exports):t(e.GraficoQL={})}("undefined"!=typeof self?self:this,function(n){var r={headers:{},method:"POST"};function o(e,t){!function(){var e="Cannot initialize GraphQLClient, cause of missing ",t=" You can resolve this by providing a polyfill for it.";if(!fetch)throw new ReferenceError(e+"fetch-function!"+t);if(!Promise)throw new ReferenceError(e+"Promise-constructor!"+t)}();this[" url"]=e;this[" options"]=a(JSON.parse(JSON.stringify(r)),t||{})}o.prototype.setHeader=function(e,t){this[" options"].headers[e]=t;return this};function a(t,r){Object.keys(r).forEach(function(e){"object"!=typeof t[e]||null===t[e]?t[e]=r[e]:Array.isArray(t[e])?Array.isArray(r[e])&&(t[e]=t[e].concat(r[e])):"object"!=typeof r[e]||null===r[e]||Array.isArray(r[e])||(t[e]=a(t[e],r[e]))});return t}function i(e,t,r){var o,n=[this[" url"]],i={resolve:null,reject:null},s={};switch(this[" options"].method.toLowerCase()){case"post":this.setHeader("Content-Type","application/json");s.body=JSON.stringify({query:t,variables:r||void 0});break;case"get":this.setHeader("Content-Type","text/plain");n.push((-1===this[" url"].indexOf("?")?"?":"&")+"query="+encodeURIComponent(t));r&&n.push("&variables="+encodeURIComponent(JSON.stringify(r)));break;default:throw new Error("Invalid method ("+this[" options"].method+"). Use method GET or POST!")}i.promise=new Promise(function(e,t){i.resolve=e;i.reject=t});o=function(e,t,r,n,o){var i;if(n.ok&&!o.errors&&o.data){if(e){o.headers=n.headers;o.status=n.status;this.resolve(o)}else this.resolve(o.data);return}(i="string"==typeof o?{error:o}:o||{}).status=n.status;e&&(i.headers=n.headers);this.reject({response:i,request:{query:t,variables:r}})}.bind(i,e,t,r);fetch(n.join(""),a(this[" options"],s)).then(function(e){var t,r,n=o.bind(null,e);((r=(t=e).headers.get("Content-Type"))&&0===r.indexOf("application/json")?t.json():t.text()).then(n,n)},function(e){i.reject({response:{status:900,error:e},request:{query:t,variables:r}})});return i.promise}o.prototype.request=function(e,t){return i.call(this,!1,e,t)};o.prototype.rawRequest=function(e,t){return i.call(this,!0,e,t)};a(n,{create:function(e,t){return new o(e,t)},request:function(e,t,r){return n.create(e).request(t,r)},rawRequest:function(e,t,r){return n.create(e).rawRequest(t,r)}})});"function"==typeof define&&define.amd&&define(["grafico-ql"],function(e){return e});